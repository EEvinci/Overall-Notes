# git checkout的用法 详解！

[toc]

## checkout和clone的区别

"checkout" 和 "clone" 是 Git 中两个不同的操作，它们的作用略有不同

1. **Clone（克隆）**：
   - 克隆操作用于将一个**完整的**远程存储库复制到本地。当你执行 `git clone <repository_url>` 命令时，Git 会将整个项目的**所有文件**、**历史记录和分支**都复制到本地计算机上的一个新目录中。
   - 克隆是一种**从头开始获取**整个项目的方式，适用于**首次获取项目**或**需要获取整个项目**的情况。
2. **Checkout（检出）**：
   - 检出操作用于在本地工作区中获取存储库中**特定文件或特定分支**的**最新版本**。你可以使用 `git checkout <branch_or_commit>` 命令来**切换分支**或**恢复特定版本的文件**。
   - 检出是一种**针对特定文件或特定分支获取最新内容**的操作，通常**用于在已经克隆的存储库中**进行工作。

克隆用于获取整个项目，而检出用于获取特定文件或特定分支的内容。

## checkout的应用场景

"checkout" 在 Git 中有几种常见的应用场景：

### **切换分支**

使用 `git checkout <branch_name>` 命令可以**切换到指定分支**。这对于**在不同的开发分支之间切换**工作非常有用。例如，当你**需要开始一个新的功能开发**时，可以**切换到相应的功能分支**；当你需要修复 bug 时，可以切换到修复分支。

#### 怎么获取当前的分支信息

要查看项目中的分支及其名称，你可以使用以下命令：

```bash
git branch
```

这个命令会列出当前仓库中的所有分支。在列出的分支中，带有星号 `*` 的表示当前所在的分支。

如果你想查看远程存储库中的分支，可以使用以下命令：

```bash
git branch -r
```

这会列出所有远程分支，而不是本地分支。在这种情况下，分支名前面通常带有远程仓库的名称，例如 `origin/main` 或 `origin/feature-branch`。

要查看远程和本地的所有分支，你可以使用以下命令：

```bash
git branch -a
```

这个命令会列出本地分支和远程分支。

### **恢复文件**

 如果你意外地修改了文件并且想要**撤销更改**，你可以使用 `git checkout -- <file_path>` 命令来**恢复文件为最近提交的版本**。这个命令将文件恢复到当前分支的最新提交中的状态。

不能选择要恢复的文件的版本，只适用于在本地对文件进行修改时出现了问题，或者修改了还不如不修改，想回退到没修改前也就是最近一次提交的文件的样子。那么就使用`git checkout -- 《文件路径》`，中间的两个--旁边都有空格

#### 想让指定文件回退到指定版本

```bash
git checkout <commit_hash> -- <file_path>
```

其中 `<commit_hash>` 是你想要恢复到的版本的哈希值，`<file_path>` 是你想要恢复的文件的路径。这样就可以将指定文件恢复到指定的版本状态。

例如，假设你想将 `file.txt` 恢复到提交历史记录中的某个特定版本，你可以执行如下命令：

```bash
git checkout abc123 -- file.txt
```

这**将 `file.txt` 恢复**到提交**哈希值为 `abc123` 的版本状态**。

##### 查看指定文件的提交记录

```bash
git log 《file》
```

关于 **`git log <file_path>`，这个命令会显示指定文件的提交历史记录，但只会包含涉及到该文件的提交**。如果该文件是**作为一次多个文件的提交的一部分提交的，那么只会显示包含该文件的提交记录**。因此，它不会显示与其他文件无关的提交记录。



### **创建分支**

可以使用 `git checkout -b <new_branch_name>` 命令创建并切换到一个新的分支。这在开始新功能开发或修复 bug 时非常常见。

#### 分支之间的提交问题

> 如果我在new_branch上修改了文件添加到了暂存区，在modify1上也修改了一个文件添加到了暂存区，但是两个都没有commit，那当我在modify1上commit的时候是否会将new_branch上add的文件也commit？

当你在两个不同的分支上修改文件并将它们添加到暂存区，但尚未提交时，每个分支上的更改虽然都在暂存区中，但它们是关于不同文件的更改（除非你修改了相同的文件并产生冲突）。当你在某个分支上提交时，这次提交将只包括该分支暂存区中的更改。

这里有个重要的点要说明：

- **暂存区是全局的**：这意味着暂存区的更改不是分支特定的。如果你在一个分支上添加了文件A到暂存区，然后在另一个分支上添加了文件B到暂存区，暂存区将包含这两个文件的更改。
- **提交操作的分支依赖性**：当你在一个分支上执行`git commit`时，Git 会创建一个新的提交，包括当前暂存区中的所有更改。这个新的提交会成为当前分支的一部分。

因此，如果你在`new_branch`上添加了文件A到暂存区，在`modify1`上添加了文件B到暂存区，然后在`modify1`分支上执行`git commit`，**这个提交将包括文件A和文件B的更改，并且这次提交将成为`modify1`分支的一部分**。文件A和文件B的更改都将从暂存区中移除，因为它们已经被提交了。

##### 如何避免潜在的问题

- **在切换分支前提交**：在**切换到另一个分支前，尽量提交当前分支的更改**，这样可以避免在暂存区中混合不同分支的更改。
- **使用`git stash`**：如果你**不想立即提交但需要切换分支，可以使用`git stash`暂时保存当前分支的更改**（包括暂存区和工作目录的更改）。之后你可以在任何需要的分支上应用这些更改。

在实际工作中，为了保持版本控制的清晰和管理的简便，推荐在进行分支切换前清理工作区和暂存区，确保每次提交都明确且只关联到当前分支的工作。这样可以减少错误和混乱的机会。

##### 演示

创建文件并commit

![image-20240423191454750](https://omen--img.oss-cn-hangzhou.aliyuncs.com/img/image-20240423191454750.png)

切换分支

![02f8fc8b467a7b836a1318307c0c406](https://omen--img.oss-cn-hangzhou.aliyuncs.com/img/02f8fc8b467a7b836a1318307c0c406.png)

### **查看历史版本**

 使用 `git checkout <commit_hash>` 命令可以查看特定提交的版本。这对于查看历史提交的更改或进行代码审阅非常有用。



### **创建临时环境**

有时候你可能需要在项目中创建一个临时环境，以便测试或调试特定的代码更改。你可以使用 `git checkout` 命令在临时分支上创建这样的环境，完成后再切换回原始分支。